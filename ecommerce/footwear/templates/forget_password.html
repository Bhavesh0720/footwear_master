{% extends 'login.html' %}
{% load static %}
{% block content %}

<main class="login-body" data-vide-bg="{% static 'assets/img/login-bg.mp4' %}">
    <form class="form-default" action="{% url 'forget_password' %}" method="POST">
        {% csrf_token %}
        <div class="login-form">
            <div class="logo-login">
                <a href="{% url 'index' %}">
                    <img src="{% static 'assets/img/logo/loder.png' %}" alt="Logo">
                </a>
            </div>
            <h2>Forget Password</h2>

            {% if not otp_sent and not otp_verified %}
                <!-- STEP 1: Enter Email -->
                <div class="form-input">
                    <label for="email">Email</label>
                    <input type="email" name="email" placeholder="Email" required>
                </div>
                <div class="form-input pt-30">
                    <input type="submit" name="send_otp" value="Send OTP">
                </div>

            {% elif otp_sent and not otp_verified %}
                <!-- STEP 2: Enter OTP -->
                <input type="hidden" name="email" value="{{ email }}">
                <div class="form-input">
                    <label for="otp">Enter OTP</label>
                    <input type="text" name="otp" placeholder="Enter OTP" required>
                </div>
                <div class="form-input pt-30">
                    <input type="submit" name="verify_otp" value="Verify OTP">
                </div>

            {% elif otp_verified %}
                <!-- STEP 3: Reset Password -->
                <input type="hidden" name="email" value="{{ email }}">
                <div class="form-input">
                    <label for="new_password">New Password</label>
                    <input type="password" name="new_password" placeholder="New Password" required>
                </div>
                <div class="form-input pt-30">
                    <input type="submit" name="reset_password" value="Reset Password">
                </div>
            {% endif %}

            {% if msg %}
                <p style="color: red;">{{ msg }}</p>
            {% endif %}

            <a href="{% url 'login' %}" class="registration">Login</a>
        </div>
    </form>
</main>

{% endblock content %}
